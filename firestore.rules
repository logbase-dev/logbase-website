rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    // ========================================
    // ğŸ” ì¸ì¦ ê´€ë ¨ í—¬í¼ í•¨ìˆ˜ë“¤
    // ========================================
    
    // ì‚¬ìš©ìê°€ ë¡œê·¸ì¸ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
    function isAuthenticated() {
      return request.auth != null;
    }
    
    // í˜„ì¬ ì‚¬ìš©ìê°€ íŠ¹ì • ì‚¬ìš©ì IDì˜ ì†Œìœ ìì¸ì§€ í™•ì¸
    function isOwner(userId) {
      return isAuthenticated() && request.auth.uid == userId;
    }
    
    // í˜„ì¬ ì‚¬ìš©ìê°€ ê´€ë¦¬ìì¸ì§€ í™•ì¸ (í–¥í›„ í™•ì¥ìš©)
    function isAdmin() {
      return isAuthenticated() && request.auth.token.admin == true;
    }
    
    // ========================================
    // ğŸ“° RSS í”¼ë“œ ë°ì´í„° ê·œì¹™
    // ========================================
    match /rss_items/{document} {
      // ì½ê¸°: ëª¨ë“  ì‚¬ìš©ì í—ˆìš© (ë¡œê·¸ì¸ ì—†ì´ë„ RSS í”¼ë“œ ë³¼ ìˆ˜ ìˆìŒ)
      allow read: if true;
      // ì“°ê¸°: ëª¨ë“  ì‚¬ìš©ì í—ˆìš© (ìŠ¤ì¼€ì¤„ëŸ¬ê°€ ì„œë²„ ì‚¬ì´ë“œì—ì„œ ì‹¤í–‰ë˜ë¯€ë¡œ)
      // TODO: ë‚˜ì¤‘ì— Admin SDKë¡œ ë³€ê²½ í›„ ë³´ì•ˆ ê°•í™” í•„ìš”
      allow write: if true;
    }
    
    // ========================================
    // ğŸ“§ ë‰´ìŠ¤ë ˆí„° êµ¬ë…ì ë°ì´í„° ê·œì¹™
    // ========================================
    match /newsletter/{document} {
      // âš ï¸ ì„ì‹œ ì„¤ì •: ì„œë²„ ì‚¬ì´ë“œ API ë¬¸ì œ í•´ê²°ì„ ìœ„í•´ ëª¨ë“  ì ‘ê·¼ í—ˆìš©
      // TODO: ë‚˜ì¤‘ì— Admin SDKë¡œ ë³€ê²½ í›„ ë³´ì•ˆ ê°•í™” í•„ìš”
      allow read, write: if true;
    }
    

    

    
    // ========================================
    // ğŸš« ê¸°ë³¸ ë³´ì•ˆ ê·œì¹™ (ëª¨ë“  ë‹¤ë¥¸ ì»¬ë ‰ì…˜)
    // ========================================
    match /{document=**} {
      // ê¸°ë³¸ì ìœ¼ë¡œ ëª¨ë“  ì ‘ê·¼ì„ ê±°ë¶€ (ë³´ì•ˆ ê°•í™”)
      allow read, write: if false;
    }
  }
} 