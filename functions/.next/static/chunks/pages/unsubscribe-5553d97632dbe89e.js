(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[785],{6266:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/unsubscribe",function(){return r(9814)}])},5692:function(e,t,r){"use strict";r.d(t,{j:function(){return n}});let n="Logbase"},9814:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return d}});var n=r(5893),i=r(7294),s=r(9008),o=r.n(s),a=r(1163),c=r(5692);function d(){let e=(0,a.useRouter)(),[t,r]=(0,i.useState)(""),[s,d]=(0,i.useState)(""),[l,u]=(0,i.useState)(!1),[h,g]=(0,i.useState)(!1),[m,f]=(0,i.useState)(""),[p,x]=(0,i.useState)(null);(0,i.useEffect)(()=>{if(e.isReady){let{email:t,token:n}=e.query;t&&n&&(r(t),d(n),b(t,n))}},[e.isReady,e.query]);let b=async(e,t)=>{try{console.log("\uD83D\uDD0D 구독자 정보 확인 중:",{email:e,token:t});let r=await fetch("/api/newsletter-subscriber-info?email=".concat(encodeURIComponent(e),"&token=").concat(t));if(console.log("\uD83D\uDCE1 API 응답 상태:",r.status),!r.ok)throw Error("HTTP error! status: ".concat(r.status));let n=await r.json();console.log("\uD83D\uDCE1 API 응답 데이터:",n),n.success?x(n.data):f(n.error||"유효하지 않은 구독 취소 링크입니다.")}catch(e){console.error("❌ 구독자 정보 확인 실패:",e),f("구독자 정보를 확인할 수 없습니다: "+(e.message||"알 수 없는 오류"))}},y=async()=>{if(!t||!s){f("필수 정보가 누락되었습니다.");return}u(!0),f("");try{let e=await fetch("/api/newsletter-subscriber-delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,token:s})}),r=await e.json();r.success?g(!0):f(r.error||"구독 취소에 실패했습니다.")}catch(e){f("구독 취소 중 오류가 발생했습니다.")}finally{u(!1)}},j=async()=>{if(!t||!s){f("필수 정보가 누락되었습니다.");return}u(!0),f("");try{let e=await fetch("/api/newsletter-subscriber-update",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,token:s,status:"active"})}),r=await e.json();r.success?(g(!1),x({...p,status:"active"})):f(r.error||"재구독에 실패했습니다.")}catch(e){f("재구독 중 오류가 발생했습니다.")}finally{u(!1)}};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(o(),{children:[(0,n.jsx)("title",{children:"뉴스레터 구독 취소 - ".concat(c.j)}),(0,n.jsx)("meta",{name:"description",content:"로그베이스 뉴스레터 구독 취소"}),(0,n.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,n.jsx)("link",{rel:"icon",href:"/images/favicon.svg"})]}),(0,n.jsx)("div",{style:{minHeight:"100vh",background:"linear-gradient(var(--gray-gradient)) no-repeat",backgroundSize:"100% 600px",padding:"2rem 1rem",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,n.jsxs)("div",{style:{maxWidth:"500px",width:"100%",background:"white",borderRadius:"15px",padding:"3rem 2rem",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1), 0 1px 3px rgba(0, 0, 0, 0.08)",border:"1px solid #e2e8f0",textAlign:"center"},children:[(0,n.jsxs)("div",{style:{marginBottom:"2rem"},children:[(0,n.jsx)("h1",{style:{fontSize:"2rem",fontWeight:"700",color:"#1a202c",marginBottom:"1rem"},children:"뉴스레터 구독 관리"}),(0,n.jsx)("p",{style:{fontSize:"1rem",color:"#4a5568",lineHeight:"1.6"},children:"로그베이스 뉴스레터 구독을 관리하세요"})]}),p&&(0,n.jsxs)("div",{style:{background:"#f7fafc",padding:"1.5rem",borderRadius:"8px",marginBottom:"2rem",border:"1px solid #e2e8f0"},children:[(0,n.jsx)("h3",{style:{fontSize:"1.1rem",fontWeight:"600",color:"#2d3748",marginBottom:"1rem"},children:"구독자 정보"}),(0,n.jsxs)("div",{style:{textAlign:"left",fontSize:"0.9rem",color:"#4a5568",lineHeight:"1.6"},children:[(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"이메일:"})," ",p.email]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"이름:"})," ",p.name||"미입력"]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"소속:"})," ",p.organization||"미입력"]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"구독 상태:"}),(0,n.jsx)("span",{style:{color:"active"===p.status?"#38a169":"#e53e3e",fontWeight:"600"},children:"active"===p.status?"구독 중":"구독 취소됨"})]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"구독 시작일:"})," ",new Date(p.createdAt).toLocaleDateString("ko-KR")]})]})]}),m&&(0,n.jsx)("div",{style:{background:"#fed7d7",color:"#c53030",padding:"1rem",borderRadius:"8px",marginBottom:"1rem",fontSize:"0.9rem"},children:m}),h&&(0,n.jsx)("div",{style:{background:"#c6f6d5",color:"#2f855a",padding:"1rem",borderRadius:"8px",marginBottom:"1rem",fontSize:"0.9rem"},children:"뉴스레터 구독이 성공적으로 취소되었습니다."}),(0,n.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[p&&"active"===p.status?(0,n.jsx)("button",{onClick:y,disabled:l,style:{background:"#e53e3e",color:"white",border:"none",padding:"1rem 2rem",borderRadius:"8px",fontSize:"1rem",fontWeight:"600",cursor:l?"not-allowed":"pointer",opacity:l?.6:1},"data-clarity-tag":"unsubscribe-cancel-subscription",children:l?"처리 중...":"구독 취소하기"}):p&&"inactive"===p.status?(0,n.jsx)("button",{onClick:j,disabled:l,style:{background:"#38a169",color:"white",border:"none",padding:"1rem 2rem",borderRadius:"8px",fontSize:"1rem",fontWeight:"600",cursor:l?"not-allowed":"pointer",opacity:l?.6:1},"data-clarity-tag":"unsubscribe-resubscribe",children:l?"처리 중...":"다시 구독하기"}):null,(0,n.jsx)("a",{href:"/",style:{background:"#4a5568",color:"white",border:"none",padding:"1rem 2rem",borderRadius:"8px",fontSize:"1rem",fontWeight:"600",textDecoration:"none",textAlign:"center"},"data-clarity-tag":"unsubscribe-back-to-home",children:"홈으로 돌아가기"})]}),(0,n.jsx)("div",{style:{marginTop:"2rem",padding:"1rem",background:"#f7fafc",borderRadius:"8px",fontSize:"0.9rem",color:"#4a5568",lineHeight:"1.6"},children:(0,n.jsxs)("p",{style:{margin:0},children:[(0,n.jsx)("strong",{children:"안내:"})," 구독을 취소하시면 더 이상 뉴스레터를 받으실 수 없습니다. 언제든지 다시 구독하실 수 있습니다."]})})]})})]})}},1163:function(e,t,r){e.exports=r(3079)}},function(e){e.O(0,[888,774,179],function(){return e(e.s=6266)}),_N_E=e.O()}]);