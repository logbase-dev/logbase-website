"use strict";(()=>{var e={};e.id=1581,e.ids=[1581],e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6249:(e,o)=>{Object.defineProperty(o,"l",{enumerable:!0,get:function(){return function e(o,t){return t in o?o[t]:"then"in o&&"function"==typeof o.then?o.then(o=>e(o,t)):"function"==typeof o&&"default"===t?o:void 0}}})},8870:(e,o,t)=>{t.r(o),t.d(o,{config:()=>c,default:()=>g,routeModule:()=>u});var s={};t.r(s),t.d(s,{default:()=>n});var l=t(1802),i=t(7153),a=t(6249),r=t(5980);async function n(e,o){if(console.log("\uD83D\uDD0D Delete API í˜¸ì¶œë¨:",{method:e.method,body:e.body}),"POST"!==e.method)return console.log("âŒ Method not allowed:",e.method),o.status(405).json({message:"Method not allowed"});try{let{guid:t}=e.body;if(console.log("\uD83D\uDCDD ë°›ì€ GUID:",t,typeof t),!t||"string"!=typeof t)return console.log("âŒ GUIDê°€ ì—†ê±°ë‚˜ ìž˜ëª»ëœ í˜•ì‹:",t),o.status(400).json({success:!1,message:"GUIDëŠ” í•„ìˆ˜ í•­ëª©ì´ë©° ë¬¸ìžì—´ì´ì–´ì•¼ í•©ë‹ˆë‹¤."});let s=t.trim();if(!s)return console.log("âŒ GUIDê°€ ë¹ˆ ë¬¸ìžì—´ìž…ë‹ˆë‹¤."),o.status(400).json({success:!1,message:"GUIDëŠ” ë¹ˆ ë¬¸ìžì—´ì¼ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."});console.log(`ðŸ—‘ï¸ RSS ì•„ì´í…œ ì‚­ì œ ìš”ì²­ ì‹œìž‘: ${s}`);let l=Buffer.from(s).toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"");console.log(`ðŸ” ì¸ì½”ë”©ëœ GUID: ${l}`);let i=r.iW.collection("rss_items").doc(l),a=await i.get();if(a.exists||s.includes("/")?a.exists||console.log(`- ì¸ì½”ë”©ëœ GUID(${l})ë¡œ ë¬¸ì„œë¥¼ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. URL í˜•íƒœ GUIDëŠ” ì§ì ‘ doc() í˜¸ì¶œì„ ê±´ë„ˆëœë‹ˆë‹¤.`):(console.log(`- ì¸ì½”ë”©ëœ GUID(${l})ë¡œ ë¬¸ì„œë¥¼ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. ì›ë³¸ GUIDë¡œ ìž¬ì‹œë„í•©ë‹ˆë‹¤.`),i=r.iW.collection("rss_items").doc(s),a=await i.get()),!a.exists){console.log(`- ì›ë³¸ GUID(${s})ë¡œë„ ë¬¸ì„œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`),console.log("- ì „ì²´ ë¬¸ì„œ ì¡°íšŒë¡œ guid í•„ë“œ ê²€ìƒ‰ ì‹œë„...");let e=await r.iW.collection("rss_items").where("guid","==",s).limit(1).get();if(e.empty)return console.log(`âŒ guid í•„ë“œë¡œë„ ë¬¸ì„œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: ${s}`),o.status(404).json({success:!1,message:"í•´ë‹¹ RSS ì•„ì´í…œì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."});let t=e.docs[0];console.log(`âœ… guid í•„ë“œë¡œ ë¬¸ì„œ ë°œê²¬: ${t.id}`);let l=t.data(),i=l.content||"",a="Logbase"===l.blogName;if(i&&a){let e=r.Hf,o=[];for(let t of([/!\[.*?\]\((http:\/\/127\.0\.0\.1:9199\/v0\/b\/[^)]+blog-images[^)]+)\)/g,/!\[.*?\]\((https:\/\/storage\.googleapis\.com\/[^)]+blog-images[^)]+)\)/g,/!\[.*?\]\((https:\/\/firebasestorage\.googleapis\.com\/v0\/b\/[^)]+blog-images[^)]+)\)/g].forEach(e=>{let t=i.match(e);t&&t.forEach(e=>{let t=e.match(/!\[.*?\]\(([^)]+)\)/);t&&o.push(t[1])})}),o))try{let o="";if(t.includes("blog-images%2F")){let e=t.split("blog-images%2F");if(e.length>1){let t=e[1].split("?")[0];o=`blog-images/${decodeURIComponent(t)}`}}else if(t.includes("blog-images/")){let e=t.split("blog-images/");if(e.length>1){let t=e[1].split("?")[0];o=`blog-images/${t}`}}if(o){let t=e.file(o),[s]=await t.exists();s?(await t.delete(),console.log("âœ… Storage ì´ë¯¸ì§€ ì‚­ì œ ì™„ë£Œ:",o)):console.log("âš ï¸ Storage íŒŒì¼ì´ ì¡´ìž¬í•˜ì§€ ì•ŠìŒ:",o)}}catch(e){console.error("âŒ Storage ì´ë¯¸ì§€ ì‚­ì œ ì‹¤íŒ¨:",t,e)}console.log(`ðŸ“ ì‚­ì œí•  ì´ë¯¸ì§€ URL ê°œìˆ˜: ${o.length}`)}else a||console.log("\uD83D\uDCDD ìžë™ ìˆ˜ì§‘ ê¸€ - Storage ì´ë¯¸ì§€ ì‚­ì œ ê±´ë„ˆë›°ê¸°");return await t.ref.delete(),console.log(`âœ… RSS ì•„ì´í…œ ì‚­ì œ ì™„ë£Œ: ${t.id}`),o.status(200).json({success:!0,message:"RSS ì•„ì´í…œê³¼ ê´€ë ¨ ì´ë¯¸ì§€ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."})}let n=a.data(),g=n.content||"",c="Logbase"===n.blogName;if(g&&c){let e=r.Hf,o=[];for(let t of([/!\[.*?\]\((http:\/\/127\.0\.0\.1:9199\/v0\/b\/[^)]+blog-images[^)]+)\)/g,/!\[.*?\]\((https:\/\/storage\.googleapis\.com\/[^)]+blog-images[^)]+)\)/g,/!\[.*?\]\((https:\/\/firebasestorage\.googleapis\.com\/v0\/b\/[^)]+blog-images[^)]+)\)/g].forEach(e=>{let t=g.match(e);t&&t.forEach(e=>{let t=e.match(/!\[.*?\]\(([^)]+)\)/);t&&o.push(t[1])})}),o))try{let o="";if(t.includes("blog-images%2F")){let e=t.split("blog-images%2F");if(e.length>1){let t=e[1].split("?")[0];o=`blog-images/${decodeURIComponent(t)}`}}else if(t.includes("blog-images/")){let e=t.split("blog-images/");if(e.length>1){let t=e[1].split("?")[0];o=`blog-images/${t}`}}if(o){let t=e.file(o),[s]=await t.exists();s?(await t.delete(),console.log("âœ… Storage ì´ë¯¸ì§€ ì‚­ì œ ì™„ë£Œ:",o)):console.log("âš ï¸ Storage íŒŒì¼ì´ ì¡´ìž¬í•˜ì§€ ì•ŠìŒ:",o)}}catch(e){console.error("âŒ Storage ì´ë¯¸ì§€ ì‚­ì œ ì‹¤íŒ¨:",t,e)}console.log(`ðŸ“ ì‚­ì œí•  ì´ë¯¸ì§€ URL ê°œìˆ˜: ${o.length}`)}else c||console.log("\uD83D\uDCDD ìžë™ ìˆ˜ì§‘ ê¸€ - Storage ì´ë¯¸ì§€ ì‚­ì œ ê±´ë„ˆë›°ê¸°");return await i.delete(),console.log(`âœ… RSS ì•„ì´í…œ ì‚­ì œ ì™„ë£Œ: ${i.id}`),o.status(200).json({success:!0,message:"RSS ì•„ì´í…œê³¼ ê´€ë ¨ ì´ë¯¸ì§€ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."})}catch(e){return console.error("âŒ RSS ì•„ì´í…œ ì‚­ì œ ì˜¤ë¥˜:",e),console.error("âŒ ì˜¤ë¥˜ ìŠ¤íƒ:",e instanceof Error?e.stack:e),o.status(500).json({success:!1,message:"RSS ì•„ì´í…œ ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",error:e instanceof Error?e.message:"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"})}}let g=(0,a.l)(s,"default"),c=(0,a.l)(s,"config"),u=new l.PagesAPIRouteModule({definition:{kind:i.x.PAGES_API,page:"/api/rss-migrate/delete",pathname:"/api/rss-migrate/delete",bundlePath:"",filename:""},userland:s})},5980:(e,o,t)=>{t.d(o,{Hf:()=>a,iW:()=>i});let s=require("firebase-admin");var l=t.n(s);!function(){if(l().apps.length>0)return l().app();let e={projectId:process.env.FIREBASE_ADMIN_PROJECT_ID,privateKey:process.env.FIREBASE_ADMIN_PRIVATE_KEY?.replace(/\\n/g,"\n"),clientEmail:process.env.FIREBASE_ADMIN_CLIENT_EMAIL},o=process.env.FIREBASE_STORAGE_EMULATOR_HOST?"logbase-blog-83db6.appspot.com":"logbase-blog-83db6.firebasestorage.app";e.privateKey?l().initializeApp({credential:l().credential.cert(e),storageBucket:o}):(console.warn("Firebase Admin private key is not set. Using default credentials."),l().initializeApp({projectId:process.env.FIREBASE_ADMIN_PROJECT_ID||"logbase-blog-83db6",storageBucket:o}))}();let i=l().firestore(),a=l().storage().bucket(),r=process.env.FIRESTORE_EMULATOR_HOST,n=process.env.FIREBASE_STORAGE_EMULATOR_HOST;r&&(console.log(`âœ… [Admin SDK] Firestore Emulator ì—°ê²°: ${r}`),console.log("   í™˜ê²½ ë³€ìˆ˜ë¥¼ í†µí•´ ìžë™ ì—°ê²°ë˜ì—ˆìŠµë‹ˆë‹¤.")),n&&(console.log(`âœ… [Admin SDK] Storage Emulator ì„¤ì •: ${n}`),console.log("   í™˜ê²½ ë³€ìˆ˜ë¥¼ í†µí•´ ìžë™ ì—°ê²°ë˜ì—ˆìŠµë‹ˆë‹¤."))},7153:(e,o)=>{var t;Object.defineProperty(o,"x",{enumerable:!0,get:function(){return t}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(t||(t={}))},1802:(e,o,t)=>{e.exports=t(145)}};var o=require("../../../webpack-api-runtime.js");o.C(e);var t=o(o.s=8870);module.exports=t})();