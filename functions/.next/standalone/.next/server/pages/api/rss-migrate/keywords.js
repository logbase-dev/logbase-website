"use strict";(()=>{var e={};e.id=1233,e.ids=[1233],e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6249:(e,o)=>{Object.defineProperty(o,"l",{enumerable:!0,get:function(){return function e(o,t){return t in o?o[t]:"then"in o&&"function"==typeof o.then?o.then(o=>e(o,t)):"function"==typeof o&&"default"===t?o:void 0}}})},1691:(e,o,t)=>{t.r(o),t.d(o,{config:()=>d,default:()=>c,routeModule:()=>u});var r={};t.r(r),t.d(r,{default:()=>l});var s=t(1802),a=t(7153),n=t(6249),i=t(5980);async function l(e,o){if(o.setHeader("Access-Control-Allow-Origin","*"),o.setHeader("Access-Control-Allow-Methods","GET, POST, PUT, DELETE, OPTIONS"),o.setHeader("Access-Control-Allow-Headers","Content-Type, Authorization"),"OPTIONS"===e.method){o.status(200).end();return}if("GET"===e.method)try{let e=i.iW.collection("rss_items"),t=await e.get(),r=new Set;t.forEach(e=>{let o=e.data();o.blogName&&r.add(o.blogName)}),o.status(200).json({success:!0,data:Array.from(r).sort()})}catch(e){console.error("í‚¤ì›Œë“œ ì¡°íšŒ ì—ëŸ¬:",e),o.status(500).json({success:!1,error:"í‚¤ì›Œë“œ ì¡°íšŒ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."})}else if("POST"===e.method)try{let{guid:t,matchedKeywords:r}=e.body;if(!t||"string"!=typeof t||!Array.isArray(r))return console.error("âŒ ìž˜ëª»ëœ íŒŒë¼ë¯¸í„°:",{guid:t,matchedKeywords:r,guidType:typeof t}),o.status(400).json({success:!1,error:"Invalid parameters: guid must be a string and matchedKeywords must be an array"});let s=t.trim();if(!s)return console.error("âŒ GUIDê°€ ë¹ˆ ë¬¸ìžì—´ìž…ë‹ˆë‹¤."),o.status(400).json({success:!1,error:"GUID cannot be empty"});console.log("\uD83D\uDD27 Keywords API í˜¸ì¶œ:",{guid:s,matchedKeywords:r});let a=new Promise((e,o)=>{setTimeout(()=>o(Error("Database operation timeout")),25e3)}),n=Buffer.from(s).toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"");console.log(`ðŸ” ì¸ì½”ë”©ëœ GUID: ${n}`);let l=i.iW.collection("rss_items").doc(n),c=await Promise.race([l.get(),a]);if(c.exists||s.includes("/")?c.exists||console.log(`- ì¸ì½”ë”©ëœ GUID(${n})ë¡œ ë¬¸ì„œë¥¼ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. URL í˜•íƒœ GUIDëŠ” ì§ì ‘ doc() í˜¸ì¶œì„ ê±´ë„ˆëœë‹ˆë‹¤.`):(console.log(`- ì¸ì½”ë”©ëœ GUID(${n})ë¡œ ë¬¸ì„œë¥¼ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. ì›ë³¸ GUIDë¡œ ìž¬ì‹œë„í•©ë‹ˆë‹¤.`),l=i.iW.collection("rss_items").doc(s),c=await Promise.race([l.get(),a])),!c.exists){console.log(`- ì›ë³¸ GUID(${s})ë¡œë„ ë¬¸ì„œë¥¼ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. guid í•„ë“œë¡œ ê²€ìƒ‰ ì‹œë„...`);let e=await Promise.race([i.iW.collection("rss_items").where("guid","==",s).limit(1).get(),a]);if(e.empty)return console.log("âŒ RSS ì•„ì´í…œì„ ì°¾ì„ ìˆ˜ ì—†ìŒ:",s),o.status(404).json({success:!1,error:"RSS item not found"});let t=e.docs[0];l=t.ref,console.log(`âœ… guid í•„ë“œë¡œ ë¬¸ì„œ ë°œê²¬: ${t.id}`)}await Promise.race([l.update({matchedKeywords:r,updatedAt:new Date}),a]),console.log("âœ… í‚¤ì›Œë“œ ì—…ë°ì´íŠ¸ ì„±ê³µ:",{docId:l.id,guid:s,matchedKeywords:r}),o.status(200).json({success:!0,message:"Keywords updated successfully"})}catch(t){console.error("âŒ Keywords API ì—ëŸ¬:",t);let e=t instanceof Error?t.message:"Unknown error";"Database operation timeout"===e?o.status(408).json({success:!1,error:"Database operation timeout"}):o.status(500).json({success:!1,error:"Internal server error: "+e})}else o.setHeader("Allow",["GET","POST"]),o.status(405).end(`Method ${e.method} Not Allowed`)}let c=(0,n.l)(r,"default"),d=(0,n.l)(r,"config"),u=new s.PagesAPIRouteModule({definition:{kind:a.x.PAGES_API,page:"/api/rss-migrate/keywords",pathname:"/api/rss-migrate/keywords",bundlePath:"",filename:""},userland:r})},5980:(e,o,t)=>{t.d(o,{Hf:()=>n,iW:()=>a});let r=require("firebase-admin");var s=t.n(r);!function(){if(s().apps.length>0)return s().app();let e={projectId:process.env.FIREBASE_ADMIN_PROJECT_ID,privateKey:process.env.FIREBASE_ADMIN_PRIVATE_KEY?.replace(/\\n/g,"\n"),clientEmail:process.env.FIREBASE_ADMIN_CLIENT_EMAIL},o=process.env.FIREBASE_STORAGE_EMULATOR_HOST?"logbase-blog-83db6.appspot.com":"logbase-blog-83db6.firebasestorage.app";e.privateKey?s().initializeApp({credential:s().credential.cert(e),storageBucket:o}):(console.warn("Firebase Admin private key is not set. Using default credentials."),s().initializeApp({projectId:process.env.FIREBASE_ADMIN_PROJECT_ID||"logbase-blog-83db6",storageBucket:o}))}();let a=s().firestore(),n=s().storage().bucket(),i=process.env.FIRESTORE_EMULATOR_HOST,l=process.env.FIREBASE_STORAGE_EMULATOR_HOST;i&&(console.log(`âœ… [Admin SDK] Firestore Emulator ì—°ê²°: ${i}`),console.log("   í™˜ê²½ ë³€ìˆ˜ë¥¼ í†µí•´ ìžë™ ì—°ê²°ë˜ì—ˆìŠµë‹ˆë‹¤.")),l&&(console.log(`âœ… [Admin SDK] Storage Emulator ì„¤ì •: ${l}`),console.log("   í™˜ê²½ ë³€ìˆ˜ë¥¼ í†µí•´ ìžë™ ì—°ê²°ë˜ì—ˆìŠµë‹ˆë‹¤."))},7153:(e,o)=>{var t;Object.defineProperty(o,"x",{enumerable:!0,get:function(){return t}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(t||(t={}))},1802:(e,o,t)=>{e.exports=t(145)}};var o=require("../../../webpack-api-runtime.js");o.C(e);var t=o(o.s=1691);module.exports=t})();