"use strict";(()=>{var e={};e.id=5407,e.ids=[5407],e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},3263:e=>{e.exports=import("firebase-admin/app")},2929:e=>{e.exports=import("firebase-admin/firestore")},6249:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,o){return o in t?t[o]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,o)):"function"==typeof t&&"default"===o?t:void 0}}})},4788:(e,t,o)=>{o.a(e,async(e,r)=>{try{o.r(t),o.d(t,{config:()=>d,default:()=>c,routeModule:()=>u});var a=o(1802),s=o(7153),i=o(6249),n=o(7008),l=e([n]);n=(l.then?(await l)():l)[0];let c=(0,i.l)(n,"default"),d=(0,i.l)(n,"config"),u=new a.PagesAPIRouteModule({definition:{kind:s.x.PAGES_API,page:"/api/rss-migrate-local",pathname:"/api/rss-migrate-local",bundlePath:"",filename:""},userland:n});r()}catch(e){r(e)}})},7008:(e,t,o)=>{o.a(e,async(e,r)=>{try{o.r(t),o.d(t,{default:()=>n});var a=o(2929),s=o(3263),i=e([a,s]);if([a,s]=i.then?(await i)():i,!(0,s.getApps)().length)try{(0,s.initializeApp)({projectId:process.env.FIREBASE_PROJECT_ID||"logbase-website"})}catch(e){console.error("Firebase Admin SDK 초기화 오류:",e)}async function n(e,t){if(t.setHeader("Access-Control-Allow-Origin","*"),t.setHeader("Access-Control-Allow-Methods","GET, POST, PUT, DELETE, OPTIONS"),t.setHeader("Access-Control-Allow-Headers","Content-Type, Authorization"),"OPTIONS"===e.method){t.status(200).end();return}if("GET"===e.method)try{let{blogName:o,pageSize:r="10",feedType:s,searchText:i="",page:n="1"}=e.query,l=parseInt(r),c=parseInt(n),d=i.toLowerCase(),u=(0,a.getFirestore)(),p=[],g=0,f=0;console.log(" 쿼리 조건:",{blogName:o,feedType:s,searchText:i,page:n,pageSize:r});let A=u.collection("rss_items"),m=await A.orderBy("isoDate","desc").get();g=m.size,console.log(" 전체 데이터 수:",g);let P=[];m.forEach(e=>{let t=e.data(),o={id:e.id,title:t.title||"",description:t.description||"",content:t.content||"",link:t.link||"",pubDate:t.pubDate||"",isoDate:t.isoDate||"",blogName:t.blogName||"",feedType:t.feedType||"noncompetitor",categories:t.categories||[],matchedKeywords:t.matchedKeywords||[],author:t.author||"",guid:t.guid||"",imageUrl:t.imageUrl||"",newsletterDate:t.newsletterDate||"",createdAt:t.createdAt||"",updatedAt:t.updatedAt||""};P.push(o)});let h=P;o&&"all"!==o&&(h=h.filter(e=>e.blogName===o)),s&&"all"!==s&&(h=h.filter(e=>e.feedType===s)),d&&(h=h.filter(e=>e.title.toLowerCase().includes(d)||e.description.toLowerCase().includes(d)||e.content.toLowerCase().includes(d))),f=h.length;let w=(c-1)*l,E=w+l;p=h.slice(w,E),console.log(" 페이지네이션:",{page:c,pageSize:l,startIdx:w,endIdx:E,resultCount:p.length,filteredCount:f}),t.status(200).json({success:!0,data:p,totalCount:g,filteredCount:f,page:c,pageSize:l,totalPages:Math.ceil(f/l)})}catch(e){console.error("RSS 데이터 조회 에러:",e),t.status(500).json({success:!1,error:"RSS 데이터 조회 중 오류가 발생했습니다.",details:e instanceof Error?e.message:"Unknown error"})}else t.setHeader("Allow",["GET"]),t.status(405).end(`Method ${e.method} Not Allowed`)}r()}catch(e){r(e)}})},7153:(e,t)=>{var o;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return o}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(o||(o={}))},1802:(e,t,o)=>{e.exports=o(145)}};var t=require("../../webpack-api-runtime.js");t.C(e);var o=t(t.s=4788);module.exports=o})();