"use strict";(()=>{var e={};e.id=8399,e.ids=[8399,2888,660],e.modules={6895:(e,t,i)=>{i.a(e,async(e,r)=>{try{i.r(t),i.d(t,{config:()=>u,default:()=>p,getServerSideProps:()=>x,getStaticPaths:()=>h,getStaticProps:()=>m,reportWebVitals:()=>g,routeModule:()=>w,unstable_getServerProps:()=>f,unstable_getServerSideProps:()=>v,unstable_getStaticParams:()=>y,unstable_getStaticPaths:()=>j,unstable_getStaticProps:()=>b});var s=i(7093),a=i(5244),n=i(1323),l=i(1070),c=i(3893),d=i(2169),o=e([c]);c=(o.then?(await o)():o)[0];let p=(0,n.l)(d,"default"),m=(0,n.l)(d,"getStaticProps"),h=(0,n.l)(d,"getStaticPaths"),x=(0,n.l)(d,"getServerSideProps"),u=(0,n.l)(d,"config"),g=(0,n.l)(d,"reportWebVitals"),b=(0,n.l)(d,"unstable_getStaticProps"),j=(0,n.l)(d,"unstable_getStaticPaths"),y=(0,n.l)(d,"unstable_getStaticParams"),f=(0,n.l)(d,"unstable_getServerProps"),v=(0,n.l)(d,"unstable_getServerSideProps"),w=new s.PagesRouteModule({definition:{kind:a.x.PAGES,page:"/newsletter/edit/[filename]",pathname:"/newsletter/edit/[filename]",bundlePath:"",filename:""},components:{App:c.default,Document:l.default},userland:d});r()}catch(e){r(e)}})},1070:(e,t,i)=>{i.r(t),i.d(t,{default:()=>a});var r=i(997),s=i(6859);function a(){return(0,r.jsxs)(s.Html,{lang:"en",children:[(0,r.jsxs)(s.Head,{children:[r.jsx("link",{rel:"icon",href:"/images/favicon.svg"}),r.jsx("script",{type:"text/javascript",dangerouslySetInnerHTML:{__html:`
              (function(c,l,a,r,i,t,y){
                  c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
                  t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
                  y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
              })(window, document, "clarity", "script", "t25pdtaagd");
            `}})]}),(0,r.jsxs)("body",{children:[r.jsx(s.Main,{}),r.jsx(s.NextScript,{})]})]})}},2169:(e,t,i)=>{i.r(t),i.d(t,{default:()=>c});var r=i(997),s=i(6689),a=i(1163),n=i(1664),l=i.n(n);function c(){let e=(0,a.useRouter)(),t=(0,a.useRouter)().query.filename,[i,n]=(0,s.useState)({title:"",content:"",url:"",sentDate:new Date().toISOString().slice(0,10),recipients:[]}),[c,d]=(0,s.useState)(!0),[o,p]=(0,s.useState)(!1),[m,h]=(0,s.useState)(""),[x,u]=(0,s.useState)(!1),[g,b]=(0,s.useState)([]),[j,y]=(0,s.useState)(!1),[f,v]=(0,s.useState)(!1),w=async r=>{if(r.preventDefault(),!i.title.trim()||!i.content.trim()||!i.sentDate){alert("제목, 내용, 발송일은 필수 항목입니다.");return}if(0===i.recipients.length){alert("수신자를 한 명 이상 선택하세요.");return}p(!0);try{let r=await fetch(`/api/newsletter-update/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)}),s=await r.json();if(r.ok)alert("뉴스레터가 성공적으로 업데이트되었습니다!"),e.push("/newsletter");else throw Error(s.message||"뉴스레터 업데이트에 실패했습니다.")}catch(t){let e=t instanceof Error?t.message:String(t);alert(`오류: ${e}`)}finally{p(!1)}},S=e=>{let{name:t,value:i}=e.target;n(e=>({...e,[t]:i}))},N=async()=>{y(!0);try{let e=await fetch("/api/newsletter-recipients");if(e.ok){let t=await e.json();b(t.recipients||[])}else console.error("수신자 목록을 불러오지 못했습니다.")}catch(e){console.error("수신자 목록 로드 오류:",e)}finally{y(!1)}},k=e=>{v(e),e?n(e=>({...e,recipients:[...g]})):n(e=>({...e,recipients:[]}))},P=(e,t)=>{t?n(t=>({...t,recipients:[...t.recipients,e]})):n(t=>({...t,recipients:t.recipients.filter(t=>t.id!==e.id)}))};return c?r.jsx("div",{className:"container",children:r.jsx("div",{className:"loading",children:"뉴스레터를 불러오는 중..."})}):m?(0,r.jsxs)("div",{className:"container",children:[r.jsx("div",{className:"error",children:m}),r.jsx(l(),{href:"/newsletter",children:r.jsx("button",{type:"button",className:"btn-back","data-clarity-tag":"newsletter-edit-back-to-list",children:"목록으로 돌아가기"})})]}):(0,r.jsxs)("div",{className:"container",children:[(0,r.jsxs)("div",{className:"header",children:[r.jsx("h1",{children:"뉴스레터 편집"}),r.jsx(l(),{href:"/newsletter",children:r.jsx("button",{type:"button",className:"btn-back","data-clarity-tag":"newsletter-edit-back-to-list",children:"목록으로 돌아가기"})})]}),(0,r.jsxs)("form",{onSubmit:w,children:[(0,r.jsxs)("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"title",children:"제목 *"}),r.jsx("input",{type:"text",id:"title",name:"title",value:i.title,onChange:S,required:!0,placeholder:"뉴스레터 제목을 입력하세요","data-clarity-tag":"newsletter-edit-title-input"})]}),(0,r.jsxs)("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"content",children:"내용 *"}),r.jsx("textarea",{id:"content",name:"content",value:i.content,onChange:S,required:!0,rows:10,placeholder:"뉴스레터 내용을 입력하세요","data-clarity-tag":"newsletter-edit-content-input"})]}),(0,r.jsxs)("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"url",children:"URL"}),r.jsx("input",{type:"url",id:"url",name:"url",value:i.url,onChange:S,placeholder:"관련 URL을 입력하세요 (선택사항)","data-clarity-tag":"newsletter-edit-url-input"})]}),(0,r.jsxs)("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"sentDate",children:"발송일 *"}),r.jsx("input",{type:"date",id:"sentDate",name:"sentDate",value:i.sentDate,onChange:S,required:!0,"data-clarity-tag":"newsletter-edit-sentdate-input"})]}),(0,r.jsxs)("div",{className:"form-group",children:[r.jsx("label",{children:"수신자 선택 *"}),(0,r.jsxs)("div",{className:"recipients-summary",children:[(0,r.jsxs)("div",{className:"recipients-count",children:[(0,r.jsxs)("span",{children:[i.recipients.length,"명 선택됨"]}),r.jsx("button",{type:"button",className:"btn-select-recipients",onClick:()=>{u(!0),N()},"data-clarity-tag":"newsletter-edit-select-recipients",children:"수신자 선택"})]}),i.recipients.length>0&&(0,r.jsxs)("div",{className:"selected-recipients",children:[r.jsx("h4",{children:"선택된 수신자:"}),r.jsx("div",{className:"recipients-grid",children:i.recipients.map(e=>(0,r.jsxs)("div",{className:"selected-recipient-item",children:[(0,r.jsxs)("div",{className:"recipient-info",children:[(0,r.jsxs)("div",{className:"recipient-info-line",children:[r.jsx("span",{className:"recipient-name",children:e.name}),(0,r.jsxs)("span",{className:"recipient-company",children:["(",e.company,")"]})]}),r.jsx("div",{className:"recipient-info-line",children:r.jsx("span",{className:"recipient-email",children:e.email})})]}),r.jsx("button",{type:"button",className:"btn-remove-recipient",onClick:()=>P(e,!1),title:`${e.name} 제거`,"data-clarity-tag":"newsletter-edit-remove-recipient",children:"\xd7"})]},e.id))})]})]})]}),r.jsx("div",{className:"form-actions",children:r.jsx("button",{type:"submit",className:"btn-submit",disabled:o,"data-clarity-tag":"newsletter-edit-submit",children:o?"저장 중...":"뉴스레터 저장"})})]}),x&&r.jsx("div",{className:"modal-overlay newsletter-edit-modal-overlay",style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3,visibility:"visible",opacity:1},children:(0,r.jsxs)("div",{className:"newsletter-edit-modal",style:{background:"white",borderRadius:"8px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)",maxWidth:"500px",width:"90%",maxHeight:"300px !important",height:"auto !important",overflow:"hidden",display:"flex",flexDirection:"column",visibility:"visible",opacity:1,margin:"auto",position:"relative",inset:"auto",minHeight:"auto !important"},children:[(0,r.jsxs)("div",{className:"modal-header",children:[r.jsx("h3",{children:"수신자 선택"}),r.jsx("button",{type:"button",className:"btn-close",onClick:()=>{u(!1)},"data-clarity-tag":"newsletter-edit-recipients-modal-close",children:"\xd7"})]}),(0,r.jsxs)("div",{className:"modal-body",children:[r.jsx("div",{style:{marginBottom:"12px"},children:(0,r.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"500",color:"#333"},children:[r.jsx("input",{type:"checkbox",checked:f,onChange:e=>k(e.target.checked),style:{width:"16px",height:"16px",margin:"0"},"data-clarity-tag":"newsletter-edit-select-all-recipients"}),(0,r.jsxs)("span",{children:["전체 선택 (",g.length,"명)"]})]})}),r.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px",maxHeight:"240px",overflowY:"auto",border:"1px solid #ddd",borderRadius:"4px",background:"white",padding:"8px"},children:j?r.jsx("div",{style:{gridColumn:"1 / -1",padding:"20px",textAlign:"center",color:"#666"},children:"수신자 목록을 불러오는 중..."}):g.map(e=>r.jsx("div",{style:{border:"1px solid #e5e7eb",borderRadius:"6px",padding:"10px",background:"#f9fafb",fontSize:"13px"},children:(0,r.jsxs)("label",{style:{display:"flex",alignItems:"flex-start",gap:"8px",cursor:"pointer",margin:"0",padding:"0",width:"100%"},children:[r.jsx("input",{type:"checkbox",checked:i.recipients.some(t=>t.id===e.id),onChange:t=>P(e,t.target.checked),style:{width:"16px",height:"16px",margin:"0",marginTop:"2px",flexShrink:"0"},"data-clarity-tag":"newsletter-edit-recipient-checkbox"}),(0,r.jsxs)("div",{style:{flex:"1",minWidth:"0"},children:[(0,r.jsxs)("div",{style:{marginBottom:"3px"},children:[r.jsx("span",{style:{fontWeight:"bold",marginRight:"4px"},children:e.name}),(0,r.jsxs)("span",{style:{color:"#666"},children:["(",e.company,")"]})]}),r.jsx("div",{style:{color:"#888",fontSize:"11px",wordBreak:"break-all"},children:e.email})]})]})},e.id))})]}),r.jsx("div",{className:"modal-footer",children:r.jsx("button",{type:"button",className:"btn-confirm",onClick:()=>{u(!1)},"data-clarity-tag":"newsletter-edit-recipients-confirm",children:"확인"})})]})})]})}},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},968:e=>{e.exports=require("next/head")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},2048:e=>{e.exports=require("fs")},5315:e=>{e.exports=require("path")},6162:e=>{e.exports=require("stream")},1568:e=>{e.exports=require("zlib")},3745:e=>{e.exports=import("firebase/app")},401:e=>{e.exports=import("firebase/auth")},1492:e=>{e.exports=import("firebase/firestore")}};var t=require("../../../webpack-runtime.js");t.C(e);var i=e=>t(t.s=e),r=t.X(0,[117,1664,6859,8342,3893],()=>i(6895));module.exports=r})();